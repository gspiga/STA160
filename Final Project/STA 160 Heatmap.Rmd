---
title: "STA 160 - Heatmaps"
author: "James Chapman"
date: "5/26/2022"
output: html_document
---

```{r results = "hide"}
library(tidyverse)
library(sf)
library(tigris)
library(viridis)
library(cowplot)
```

```{r}
census <- read.csv('census_clean.csv', header = T)
names(census)[names(census) == 'ST'] <- 'STATEFIP'
census
```

```{r}
# Be sure to mention filtering out certain states

census <- census %>% group_by(STATEFIP) %>% 
  select(STATEFIP, RPL_THEME1, RPL_THEME2, RPL_THEME3, RPL_THEME4, RPL_THEMES) %>% 
  filter(!STATEFIP %in% c(2,15) & STATEFIP <= 56) %>% 
  summarise_all(list(mean)) %>% 
  ungroup

census
```

```{r}
states <- states(class = "sf")
states$STATEFIP <- as.numeric(states$STATEFP)

ggplot(states) + geom_sf() +
  theme_map() + coord_sf(datum = NA)
```

```{r}
census_map <- inner_join(census, states) %>% st_as_sf()
```


```{r}
map1 <- ggplot(census_map, aes(fill = RPL_THEME1)) + geom_sf() +
            theme_map() + coord_sf(datum = NA) +
            labs(title = "Socioeconomic Score, by State", fill = "Score") +
            scale_fill_viridis(option = "plasma",breaks=c(0,.25,.5,.75,1),labels=c(0,.25,.5,.75,1),limits=c(0,1))

map1

map2 <- ggplot(census_map, aes(fill = RPL_THEME2)) + geom_sf() +
            theme_map() + coord_sf(datum = NA) +
            labs(title = "Household Composition/Disability Score, by State", fill = "Score") +
            scale_fill_viridis(option = "plasma",breaks=c(0,.25,.5,.75,1),labels=c(0,.25,.5,.75,1),limits=c(0,1))

map2

map3 <- ggplot(census_map, aes(fill = RPL_THEME3)) + geom_sf() +
            theme_map() + coord_sf(datum = NA) +
            labs(title = "Minority Status/Language, by State", fill = "Score") +
            scale_fill_viridis(option = "plasma",breaks=c(0,.25,.5,.75,1),labels=c(0,.25,.5,.75,1),limits=c(0,1))

map3

map4 <- ggplot(census_map, aes(fill = RPL_THEME4)) + geom_sf() +
            theme_map() + coord_sf(datum = NA) +
            labs(title = "Housing Type/Transportation, by State", fill = "Score") +
            scale_fill_viridis(option = "plasma",breaks=c(0,.25,.5,.75,1),labels=c(0,.25,.5,.75,1),limits=c(0,1))

map4

map5 <- ggplot(census_map, aes(fill = RPL_THEMES)) + geom_sf() +
            theme_map() + coord_sf(datum = NA) +
            labs(title = "Overall Score, by State", fill = "Score") +
            scale_fill_viridis(option = "plasma",breaks=c(0,.25,.5,.75,1),labels=c(0,.25,.5,.75,1),limits=c(0,1))

map5
```


























